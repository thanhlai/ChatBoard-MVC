@{
    ViewBag.Title = "Chat";
}
@Styles.Render("~/Content/css")

<div class="container">
    <header class="row">
        <div class="col-md-2">
            <div class="logo" title="ChatBoard"></div>
        </div>
        <div class="col-md-8"></div>
        <div class="col-md-2">
            <div class="btn btn-default action-dropdown">Invite</div>
        </div>
    </header>
    <div class="row">
        <div class="col-md-2">
            <ul class="rooms-listing">
                <li>What is your name?</li>
                <li>What is your name?</li>
                <li>What is your name?</li>
                <li>What is your name?</li>
                <li>What is your name?</li>
                <li class="active">Creating Chat Room in ASP.NET</li>
                <li>What is your name?</li>
            </ul>
        </div>
        <div class="col-md-8 discussion-body">
            <div class="topic-header">
                <div class="topic-title">Creating Chat Room in ASP.NET</div>
                <div class="topic-description">I am trying to create a basic chat room to enhance my professional portfolio</div>
                <div class="topic-tags"><span class="glyphicon glyphicon-tags"></span>asp.net, website</div>
            </div>
            <div class="pinned-answers">
                Pinned answers <span class="glyphicon glyphicon-pushpin pull-right"></span>
            </div>
            <div class="chat">
                <div class="chat-content">
                    <ul id="discussion"></ul>
                </div>
                <div class="chat-message">
                    <div class="message">
                        <input type="text" id="message" />
                    </div>
                    <input class="btn btn-primary" type="button" id="sendmessage" value="Send" />
                </div>
            </div>
        </div>
        <div class="col-md-2 users">
            <ul class="users-listing">
                <li>User 1</li>
                <li>User 2</li>
                <li>User 3</li>
                <li>User 4</li>
                <li>User 5</li>
            </ul>
        </div>
    </div>
</div>
@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.1.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var chat = $.connection.chatHub;
            // Create a function that the hub can call back to display messages.
            chat.client.addNewMessageToPage = function (name, message) {
                // Add the message to the page.
                $('#discussion').append('<li>'+ name +' : '+ message+ '</li>');
            };
            // Set initial focus to message input box.
            $('‪#‎message‬').focus();
            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    // Call the Send method on the hub.
                    if ($('#message').val().trim() != '') {
                        chat.server.send($('#displayname').val(), $('#message').val());
                        // Clear text box and reset focus for next comment. 
                        $('#message').val('').focus();
                    }
                });
                document.onkeypress = function (e) {
                    if (e.keyCode == 13) {
                        if ($('#message').val().trim() != '') {
                            chat.server.send('Thanh', $('#message').val());
                            $('#message').val('').focus();
                        }
                    }
                }
            });
        });
    </script>
}
